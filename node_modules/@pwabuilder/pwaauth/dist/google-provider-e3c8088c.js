class e{constructor(e){this.clientId=e}signIn(){return this.loadDependencies().then(()=>this.signInWithGoogleAuth2())}loadDependencies(){return this.appendGoogleScript().then(()=>this.loadAuth())}appendGoogleScript(){var i;return(null===(i=window.gapi)||void 0===i?void 0:i.load)?Promise.resolve():new Promise((i,o)=>{const n=window.document.createElement("script");n.async=!0,n.src=e.apiUrl,n.onload=()=>i(),n.onerror=e=>o({message:"Error loading Google Platform library",error:e}),window.document.head.appendChild(n)})}loadAuth(){return window.gapi&&window.gapi.load?window.gapi.auth2?Promise.resolve():new Promise(e=>window.gapi.load("auth2",()=>e())):Promise.reject("Couldn't find gapi.load")}signInWithGoogleAuth2(){if(!(null===gapi||void 0===gapi?void 0:gapi.auth2))return Promise.reject("gapi.auth2 wasn't loaded");const e=gapi.auth2.init({client_id:this.clientId,cookie_policy:"single_host_origin"});if(e.isSignedIn.get()){const i=e.currentUser.get();return Promise.resolve(this.getSignInResultFromUser(i))}return e.signIn().then(e=>this.getSignInResultFromUser(e))}getSignInResultFromUser(e){const i=e.getBasicProfile(),o=e.getAuthResponse(!0);return{email:i.getEmail(),name:i.getName(),imageUrl:i.getImageUrl(),accessToken:null==o?void 0:o.access_token,accessTokenExpiration:new Date(o.expires_at),provider:"Google",error:null,providerData:e}}}e.apiUrl="https://apis.google.com/js/api:client.js";export{e as GoogleProvider};
